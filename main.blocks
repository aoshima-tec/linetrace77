<xml xmlns="https://developers.google.com/blockly/xml"><variables><variable id="vsr8@,0d=j#}%kzZ=n%p">g_mode</variable><variable id="q7t!?U;s?F/3JZRKZJA!">g_time</variable><variable id="|nX}a!]b2XygFclJ5ag)">g_speed_reft</variable><variable id="s1hwOrKfV~K-P#]oRG3i">g_speed_right</variable><variable id="p8QhhW$BGvzAytIB}pxZ">c_mtime</variable><variable id=",P@/r/(ux;{Tr6qAeQC[">g_speed</variable></variables><block type="pxt-on-start" id="@~N[YM}r+q*OX7@E]*@." x="0" y="0"><statement name="HANDLER"><block type="typescript_statement" id="Zdc+b7yFdYLwrVbJQB}X" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let g_mode = &quot;&quot;" numlines="1" declaredvars="g_mode"></mutation><next><block type="variables_set" id="Xm+,2!*|X)FD-;GdSvu|"><field name="VAR" id="p8QhhW$BGvzAytIB}pxZ">c_mtime</field><value name="VALUE"><shadow type="math_number" id="068eYdM$BvT-TS2hs3Rm"><field name="NUM">1000</field></shadow></value><next><block type="variables_set" id="iQQwEW2FSClU+ecc88!i"><field name="VAR" id="q7t!?U;s?F/3JZRKZJA!">g_time</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="math_arithmetic" id="Fl[a2t=k:~nzk+lZiPR,"><field name="OP">ADD</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="device_get_running_time" id="pD:{4:7Q~i3Xkb!9*V)("/></value><value name="B"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="I*/SHMrK,)#zf1|r9I%s"><field name="VAR" id="p8QhhW$BGvzAytIB}pxZ">c_mtime</field></block></value></block></value><next><block type="variables_set" id="@%`gOj^dHm!l*+TNPUS#"><field name="VAR" id="vsr8@,0d=j#}%kzZ=n%p">g_mode</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="text" id=",3K)gwCGR.6PbOdxys/Z"><field name="TEXT">Stop</field></block></value><next><block type="variables_set" id="QCBOEN9qoN3NZk.IE94{"><field name="VAR" id=",P@/r/(ux;{Tr6qAeQC[">g_speed</field><value name="VALUE"><shadow type="math_number" id="pY$/E`|U:?O}%oRADSJc"><field name="NUM">30</field></shadow></value><next><block type="typescript_statement" id="7w]@@}za%=ssGKTi8tkr" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let g_led_left:maqueen.LEDswitch = maqueen.LEDswitch.turnOn" numlines="1" declaredvars="g_led_left"></mutation><next><block type="typescript_statement" id="h~,:aqx]F0]XuKTI7Grm" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let g_led_right:maqueen.LEDswitch = maqueen.LEDswitch.turnOff" numlines="1" declaredvars="g_led_right"></mutation><next><block type="radio_set_group" id=":I^%A;P.60D.Ke39phJ]"><value name="ID"><shadow type="math_number_minmax" id="Fe~.y`Uc36I7[q+merd~"><mutation min="0" max="255" label="Number" precision="0"/><field name="SLIDER">1</field></shadow></value><next><block type="basic_show_icon" id="KeiAa;VG#(J@@h)4!:SP"><field name="i">IconNames.Asleep</field></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type="device_button_event" id="B~fjn.ZO*5H?^R+(Y?3z" x="715" y="0"><field name="NAME">Button.A</field><comment>送信機のAボタンが押されたら&#10;・動作指示を走行とする&#10;・動作指示に対応したアイコンの表示&#10;・動作指示の送信&#10;を行う。</comment><statement name="HANDLER"><block type="variables_set" id="NIJCL%QCw$+63#4.g/ER"><field name="VAR" id="vsr8@,0d=j#}%kzZ=n%p">g_mode</field><comment>動作を決定</comment><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="text" id=",TO-d,G#Sj!5s(:!!/2;"><field name="TEXT">Run</field></block></value><next><block type="function_call" id="2REWU6F83Ta]xM33$Sd*"><mutation name="showIcon" functionid="ZusH}!2gDk5wla;uyxDh"/><comment>アイコンの表示</comment><next><block type="radio_datagram_send_string" id="?-P=9,$6L93$C=k2a78("><comment>動作指示を送信</comment><value name="msg"><block type="variables_get" id="[g~ZndH$NJy0ve8^Z1qn"><field name="VAR" id="vsr8@,0d=j#}%kzZ=n%p">g_mode</field></block></value></block></next></block></next></block></statement></block><block type="function_definition" id="[p?_YKL$lB6sGz{vY+*-" x="1157" y="0"><mutation name="led_on" functionid="5/;=-~b*~{jAUpEChAF:"><arg name="mtime" id="9epgcvrm2cphhctr68t2" type="number"/></mutation><field name="function_name">led_on</field><comment>フロントＬＥＤ表示関数&#10;・交互に点滅を繰り返す</comment><statement name="STACK"><block type="controls_if" id="IPIXmH`2K-b_r!];~{vF"><value name="IF0"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="L-$f[(DlW8E[.vos%9%7"><field name="OP">LT</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get" id="BeJFVaD%xU5WhGM;ZsHo"><field name="VAR" id="q7t!?U;s?F/3JZRKZJA!">g_time</field></block></value><value name="B"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="device_get_running_time" id="KKc`YQv1lH,c^#(IwPh]"/></value></block></value><statement name="DO0"><block type="typescript_statement" id="jvk#C,FGZ?.S5~iKAG.f" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="g_led_left = (g_led_left == maqueen.LEDswitch.turnOff) ? maqueen.LEDswitch.turnOn : g_led_right = maqueen.LEDswitch.turnOff" numlines="1"></mutation><next><block type="typescript_statement" id="Yp,!piN=.2TqSRf*Sa?l" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="g_led_right = (g_led_right == maqueen.LEDswitch.turnOff) ? maqueen.LEDswitch.turnOn : g_led_right = maqueen.LEDswitch.turnOff" numlines="1"></mutation><next><block type="variables_set" id=":MX,d1?did~SAUP#oIyF"><field name="VAR" id="q7t!?U;s?F/3JZRKZJA!">g_time</field><comment>次の点滅時間の算出</comment><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="math_arithmetic" id="OO=K+90#|+9xRZ;}Bkw6"><field name="OP">ADD</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="device_get_running_time" id="SF-53L`aWswLh2-x1LxS"/></value><value name="B"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="argument_reporter_number" id="_Dn.s[8gYjtch!%H8C9y"><field name="VALUE">mtime</field></block></value></block></value></block></next></block></next></block></statement><next><block type="typescript_statement" id="0M~q)9e:h~i1WJWU(P9E" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="maqueen.writeLED(maqueen.LED.LEDLeft, g_led_left)" numlines="1"></mutation><next><block type="typescript_statement" id="XJja1GVi5/(|`@)F4a~}" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="maqueen.writeLED(maqueen.LED.LEDRight, g_led_right)" numlines="1"></mutation></block></next></block></next></block></statement></block><block type="radio_on_string_drag" id="Q6E8}+[.UpqyL6[1/0`z" x="2555" y="0"><comment>送信機からの動作指示を受信して&#10;・動作の決定&#10;・動作に対応したアイコン表示&#10;を行う。</comment><value name="HANDLER_DRAG_PARAM_receivedString"><shadow type="argument_reporter_string" id="W5Zc6N;R.+|k5#c/G?Xd"><field name="VALUE">receivedString</field></shadow></value><statement name="HANDLER"><block type="variables_set" id="lIwCgrV;Ep;Wcc-bDt!7"><field name="VAR" id="vsr8@,0d=j#}%kzZ=n%p">g_mode</field><comment>受信した動作指示を保存</comment><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="argument_reporter_string" id="WJ{{}mhzPU}gorK0DOE,"><field name="VALUE">receivedString</field></block></value><next><block type="function_call" id="a5aQpW9ZMR9NJ[`@`c;b"><mutation name="showIcon" functionid="ZusH}!2gDk5wla;uyxDh"/><comment>アイコンの表示</comment></block></next></block></statement></block><block type="device_button_event" id="%WV%40+`.]*{8,kSvGJd" x="0" y="579"><field name="NAME">Button.B</field><comment>送信機のBボタンが押されたら&#10;・動作指示を停止とする&#10;・動作指示に対応したアイコンの表示&#10;・動作指示の送信&#10;を行う。</comment><statement name="HANDLER"><block type="variables_set" id="E{a+SUO:bL-@qmHj~1+D"><field name="VAR" id="vsr8@,0d=j#}%kzZ=n%p">g_mode</field><comment>動作を決定</comment><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="text" id="f2is7K+ywl*k/%:G,jrR"><field name="TEXT">Stop</field></block></value><next><block type="function_call" id="zG4u=*cJNW+mlI3g%lN}"><mutation name="showIcon" functionid="ZusH}!2gDk5wla;uyxDh"/><comment>アイコンの表示</comment><next><block type="radio_datagram_send_string" id="-y_!QcHU:48hQSx]`vhI"><comment>動作指示を送信</comment><value name="msg"><block type="variables_get" id="/LM?KTd#~O$.nT/ru#E["><field name="VAR" id="vsr8@,0d=j#}%kzZ=n%p">g_mode</field></block></value></block></next></block></next></block></statement></block><block type="function_definition" id="dz)Y?gn@p^4BNLY{K1P[" x="419" y="579"><mutation name="lineTrace" functionid="/?~MU-K-(FG{tOBJW8Q9"><arg name="speed" id="v37pzwjngnifooqvot8bk" type="number"/></mutation><field name="function_name">lineTrace</field><comment>ライントレース走行関数&#10;・全タイヤライン上&#10;・左タイヤ逸脱&#10;・右タイヤ逸脱&#10;・全タイヤ逸脱&#10;上記の場合のタイヤ回転指示を行う。</comment><statement name="STACK"><block type="controls_if" id="MNt;QlaJmyJPk_o%5$Ec"><mutation elseif="2"/><comment>全タイヤライン上（左右：回転）&#10;左タイヤのライン逸脱（左：回転・右：停止）&#10;右タイヤのライン逸脱（右：回転・左：停止）</comment><value name="IF0"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_operation" id="9YI|X,#v_`P9-b93PAm="><field name="OP">AND</field><value name="A"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="c^OQ#(kskSqr4iUOas_7"><field name="OP">EQ</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="read_Patrol" id="V!jhoDe[SN5Spfp5^GRT"><field name="patrol">maqueen.Patrol.PatrolLeft</field></block></value><value name="B"><shadow type="math_number" id="VA[D]!_|R?ePq~.9;Z*I"><field name="NUM">0</field></shadow></value></block></value><value name="B"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="sp(}PuZRl}w9!BJoz/nB"><field name="OP">EQ</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="read_Patrol" id="=n/h9m`e9],V{Nkl||gp"><field name="patrol">maqueen.Patrol.PatrolRight</field></block></value><value name="B"><shadow type="math_number" id=";K-H`pn,Pg:bnZRCRrk%"><field name="NUM">0</field></shadow></value></block></value></block></value><statement name="DO0"><block type="variables_set" id="YyrXD;*lYjHE5q#+|q~d"><field name="VAR" id="|nX}a!]b2XygFclJ5ag)">g_speed_reft</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="argument_reporter_number" id=".7[.[g.eidU0!b3oP;9#"><field name="VALUE">speed</field></block></value><next><block type="variables_set" id="bi6iJ;SHsQr`xr,hD^Q="><field name="VAR" id="s1hwOrKfV~K-P#]oRG3i">g_speed_right</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="argument_reporter_number" id="#8bzuFjlXCU45Q9AH23?"><field name="VALUE">speed</field></block></value></block></next></block></statement><value name="IF1"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_operation" id="RH`07-~l*C1ON$tg.4$I"><field name="OP">AND</field><value name="A"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="-@R`L8[.aQ78hgYV+jHa"><field name="OP">EQ</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="read_Patrol" id="zSREiEW(a$iIM:?jM#5P"><field name="patrol">maqueen.Patrol.PatrolLeft</field></block></value><value name="B"><shadow type="math_number" id="{2]dcj$;TDXe0oV9yL0t"><field name="NUM">1</field></shadow></value></block></value><value name="B"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="f57,/K8$d8Ao!%7Uo/2:"><field name="OP">EQ</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="read_Patrol" id="xpqV,tLw7Z*`.!@.Ignp"><field name="patrol">maqueen.Patrol.PatrolRight</field></block></value><value name="B"><shadow type="math_number" id="8s|U.+Ww/1IB/Tps:nB|"><field name="NUM">0</field></shadow></value></block></value></block></value><statement name="DO1"><block type="variables_set" id="~XlNg,~u?ep0-?0LKl1Q"><field name="VAR" id="|nX}a!]b2XygFclJ5ag)">g_speed_reft</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="argument_reporter_number" id="e`aZFUB$[S*Uv,mv:WHn"><field name="VALUE">speed</field></block></value><next><block type="variables_set" id="4~*+;9zLf68pih~41/C#"><field name="VAR" id="s1hwOrKfV~K-P#]oRG3i">g_speed_right</field><value name="VALUE"><shadow type="math_number" id="~jkavb+aje=~-6!AI[+Q"><field name="NUM">0</field></shadow></value></block></next></block></statement><value name="IF2"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_operation" id=":PP9u]/vFn-pxhLROczT"><field name="OP">AND</field><value name="A"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="RxePN]4_1Rcjq|M6jIV-"><field name="OP">EQ</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="read_Patrol" id="*G+n-|%f-$t:.HfW0Lb0"><field name="patrol">maqueen.Patrol.PatrolLeft</field></block></value><value name="B"><shadow type="math_number" id="~kJCX3F$^GR)g;BQ}}~`"><field name="NUM">0</field></shadow></value></block></value><value name="B"><shadow type="logic_boolean"><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id="2fCt.{/$n/?]fU~2e-e%"><field name="OP">EQ</field><value name="A"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="read_Patrol" id="AKuA%7=|XwOXJ9TD3t`v"><field name="patrol">maqueen.Patrol.PatrolRight</field></block></value><value name="B"><shadow type="math_number" id=")8UmZ//u9/C)]Twf;GI`"><field name="NUM">1</field></shadow></value></block></value></block></value><statement name="DO2"><block type="variables_set" id="]B;o.U;#Sm}/5T(^goW9"><field name="VAR" id="|nX}a!]b2XygFclJ5ag)">g_speed_reft</field><value name="VALUE"><shadow type="math_number" id="zSKh#}=Z@`]%k|eeij-W"><field name="NUM">0</field></shadow></value><next><block type="variables_set" id="pHzzY;]Gq2)#!cd/B8dL"><field name="VAR" id="s1hwOrKfV~K-P#]oRG3i">g_speed_right</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="argument_reporter_number" id="[!5s:S`V#,jz-NhdQwB8"><field name="VALUE">speed</field></block></value></block></next></block></statement><next><block type="motor_MotorRun" id="AenOXa(6@d%;sv-b){1M"><field name="index">maqueen.Motors.M1</field><field name="Dir">maqueen.Dir.CW</field><comment>全タイヤ回転動作指示（全タイヤ逸脱：前回の動作指示を継続）</comment><value name="speed"><shadow type="math_number_minmax"><mutation min="0" max="255"/><field name="SLIDER">0</field></shadow><block type="variables_get" id="bJDYW=J%QJ=1:K%{5=pi"><field name="VAR" id="|nX}a!]b2XygFclJ5ag)">g_speed_reft</field></block></value><next><block type="motor_MotorRun" id="ag4}=Z*,@uf;hjL{-Kl#"><field name="index">maqueen.Motors.M2</field><field name="Dir">maqueen.Dir.CW</field><value name="speed"><shadow type="math_number_minmax"><mutation min="0" max="255"/><field name="SLIDER">0</field></shadow><block type="variables_get" id="RR)iZk~!rjni#wAzIzzS"><field name="VAR" id="s1hwOrKfV~K-P#]oRG3i">g_speed_right</field></block></value></block></next></block></next></block></statement></block><block type="function_definition" id="t9%L5hq$1(oy2V|ytsR;" x="1601" y="579"><mutation name="Stop" functionid="T%5h_b*BWf.!zXQcW^}Z"/><field name="function_name">Stop</field><comment>走行停止動作関数&#10;・全モータ停止</comment><statement name="STACK"><block type="motor_motorStop" id="NZy$Yj$OHmO44(wHp{jA"><field name="motors">maqueen.Motors.All</field></block></statement></block><block type="device_forever" id="qQ3lZ==;S)o3l)V/?GQl" x="1992" y="579"><comment>主処理&#10;動作モードに従った以下の処理を行う。&#10;・ライントレース&#10;・走行停止&#10;・フロントＬＥＤ点滅</comment><statement name="HANDLER"><block type="typescript_statement" id="%:SG32iH92bq)AN,.6pn" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="switch (g_mode)" line1="    {" line2="    case &quot;Run&quot;:" line3="        lineTrace(g_speed)" line4="        led_on(c_mtime)" line5="        break" line6="    case &quot;Stop&quot;:" line7="        Stop()" line8="        break" line9="    }" numlines="10"></mutation></block></statement></block><block type="function_definition" id="oPNt{dtX(TsVspB34;,I" x="2370" y="579"><mutation name="showIcon" functionid="ZusH}!2gDk5wla;uyxDh"/><field name="function_name">showIcon</field><comment>動作モードに従ったアイコン表示関数</comment><statement name="STACK"><block type="typescript_statement" id="^U7ck;IZwHT$0ui3Vzqg" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="switch (g_mode) {" line1="    // 走行モード（笑い顔）" line2="    case &quot;Run&quot;:" line3="        basic.showIcon(IconNames.Happy)" line4="        break" line5="    // 停止モード（泣き顔）" line6="    case &quot;Stop&quot;:" line7="        basic.showIcon(IconNames.Sad)" line8="        break" line9="    }" numlines="10"></mutation></block></statement></block></xml>